# GazeHome AI Services - 데모 실행 가이드

## 📋 개요

GazeHome AI Services의 데모 실행 방법을 단계별로 설명합니다.

## 🎯 데모 종류

### 1. **대회/프레젠테이션용 데모** (추천)
- **파일**: `examples/run_demo.py`
- **목적**: 30분 대기 없이 다양한 기상 조건에서 AI 추천 즉시 시연
- **대상**: 대회, 프레젠테이션, 고객 시연

### 2. **개발자용 자동 테스트**
- **파일**: `examples/dev_auto_test.py`
- **목적**: 전체 시스템 자동 검증
- **대상**: 개발자, QA 테스트

## 🚀 대회/프레젠테이션용 데모 실행

### **1단계: 환경 준비**

#### 1.1 가상환경 활성화
```bash
# Windows
source .venv/Scripts/activate

# Linux/Mac
source .venv/bin/activate
```

#### 1.2 의존성 설치 확인
```bash
pip install -r requirements.txt
```

### **2단계: 실제 서버 연결 설정**

#### 2.1 .env 파일 수정
```bash
# .env 파일에서 실제 서버 URL로 변경
GATEWAY_URL=http://실제_Gateway_서버_IP:포트
HARDWARE_URL=http://실제_Hardware_서버_IP:포트
```

**예시:**
```bash
# 실제 서버 연결 예시
GATEWAY_URL=http://192.168.1.100:9000
HARDWARE_URL=http://192.168.1.101:8080
```

#### 2.2 서버 연결 확인
```bash
# Gateway 서버 연결 테스트
curl http://실제_Gateway_서버_IP:포트/api/lg/devices

# Hardware 서버 연결 테스트  
curl http://실제_Hardware_서버_IP:포트/api/recommendations
```

### **3단계: AI 서버 실행**

#### 3.1 AI 서버 시작
```bash
# 터미널 1: AI 서버 실행
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**예상 출력:**
```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     GazeHome AI Services 시작 중...
INFO:     Gateway URL: http://실제_Gateway_서버_IP:포트
INFO:     Hardware URL: http://실제_Hardware_서버_IP:포트
INFO:     MongoDB 연결 완료
INFO:     스케줄러 자동 시작 완료 (간격: 30분)
```

### **4단계: 데모 실행**

#### 4.1 데모 스크립트 실행
```bash
# 터미널 2: 데모 실행
python examples/run_demo.py
```

#### 4.2 데모 메뉴 선택
```
🎯 GazeHome AI Services - 스마트 홈 데모
============================================================
30분 대기 없이 다양한 기상 조건에서 AI 추천을 즉시 시연합니다!
============================================================

📋 실행할 데모를 선택하세요:
1. 스마트 홈 AI 추천 데모 (기상 + 시간대별 시나리오)
2. 종료

선택 (1-2): 1
```

#### 4.3 시나리오 선택
```
🏠 스마트 홈 AI 추천 데모 시작
==================================================
다양한 기상 조건과 시간대에서 AI 추천을 시연합니다!
==================================================

📋 시나리오를 선택하세요:
1. 기상 시나리오 (여름 폭염, 겨울 한파, 봄 황사, 여름 장마, 가을 환절기, 겨울 건조)
2. 시간대별 시나리오 (아침 7시, 점심 12시, 저녁 6시, 밤 10시)
3. 개별 시나리오 선택
4. 전체 시나리오 실행

선택 (1-4): 1
```

## 🌤️ 기상 시나리오 데모

### **시나리오 목록**
1. **여름 폭염**: 기온 35도, 폭염주의보
2. **겨울 한파**: 기온 영하 10도, 한파주의보
3. **봄 황사**: 미세먼지 농도 매우 나쁨
4. **여름 장마**: 습도 80% 이상
5. **가을 환절기**: 일교차 큰 환절기
6. **겨울 건조**: 습도 30% 이하

### **데모 실행 과정**

#### 1. AI 추천 생성
```
🌤️ 여름 폭염
----------------------------------------
📝 상황: 현재 기온이 35도로 폭염주의보가 발령되었습니다. 실내 온도도 30도를 넘어서 매우 더운 상황입니다.
✅ AI 추천 생성 성공!
💬 AI 응답: 에어컨 켤까요? - 현재 온도가 35도이므로 에어컨을 키시는 것을 추천드립니다.
```

#### 2. 사용자 응답 입력
```
❓ 이 추천을 실행하시겠습니까?
YES/NO 입력: YES
👤 사용자 응답: YES
```

#### 3. 실제 기기 제어 실행
```
🎯 제어 정보: 에어컨1 -> turn_on

🔧 실제 Gateway를 통한 기기 제어 실행:
  📱 기기: 에어컨1 (실제_기기_ID)
  ⚡ 액션: turn_on
  🔄 제어 중...

✅ 실제 에어컨 켜기 완료!
```

## 🕐 시간대별 시나리오 데모

### **시나리오 목록**
1. **아침 7시**: 출근 준비, 실내 온도 22도
2. **점심 12시**: 실내 온도 28도, 점심 준비로 부엌이 더워짐
3. **저녁 6시**: 퇴근 후 집 도착, 실내 온도 26도
4. **밤 10시**: 잠자리 준비, 실내 온도 24도

## 🎯 개별 시나리오 선택

### **선택 가능한 시나리오**
```
📋 사용 가능한 시나리오:
1. 여름 폭염
2. 겨울 한파
3. 봄 황사
4. 여름 장마
5. 가을 환절기
6. 겨울 건조
7. 아침 7시
8. 점심 12시
9. 저녁 6시
10. 밤 10시

시나리오 선택 (1-10): 3
```

## 🔧 개발자용 자동 테스트 (Mock 서버 사용)

### **실행 방법**
```bash
# 터미널 1: Mock 서버 실행
python examples/mock_servers.py

# 터미널 2: AI 서버 실행  
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# 터미널 3: 자동 테스트 실행
python examples/dev_auto_test.py
```

### **테스트 내용**
1. **API 엔드포인트 테스트**
   - Mock Gateway API 연결 테스트
   - Mock Hardware API 연결 테스트
   - AI 서버 API 연결 테스트

2. **추천 시스템 테스트**
   - AI 추천 생성 테스트
   - 기기 상태 확인 테스트
   - Mock 제어 실행 테스트

3. **스케줄러 테스트**
   - 스케줄러 시작/중지 테스트
   - 자동 추천 생성 테스트

## ⚠️ 문제 해결

### **일반적인 오류**

#### 1. **포트 충돌 오류**
```
ERROR: [Errno 48] Address already in use
```
**해결방법:**
```bash
# 포트 사용 중인 프로세스 확인
netstat -ano | findstr :8000
netstat -ano | findstr :9000
netstat -ano | findstr :8080

# 프로세스 종료
taskkill /PID <프로세스ID> /F
```

#### 2. **실제 서버 연결 오류**
```
httpx.ConnectError: All connection attempts failed
```
**해결방법:**
- 실제 Gateway/Hardware 서버가 실행 중인지 확인
- `.env` 파일의 서버 URL이 올바른지 확인
- 네트워크 연결 상태 확인
- 방화벽 설정 확인

#### 3. **MongoDB 연결 오류**
```
WARNING: MongoDB 연결 실패
```
**해결방법:**
- `.env` 파일의 `MONGODB_URL` 확인
- MongoDB Atlas 클러스터 상태 확인
- 네트워크 연결 상태 확인

#### 4. **AI 서버 연결 오류**
```
httpx.ConnectError: All connection attempts failed
```
**해결방법:**
- AI 서버가 실행 중인지 확인
- 포트 8000이 열려있는지 확인
- 방화벽 설정 확인

### **로그 확인 방법**

#### 1. **AI 서버 로그**
```bash
# 터미널에서 AI 서버 실행 시 실시간 로그 확인
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

#### 2. **실제 서버 연결 로그**
```bash
# AI 서버 실행 시 실제 서버 연결 상태 확인
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**실제 서버 연결 확인 로그:**
```
INFO:     Gateway URL: http://실제_Gateway_서버_IP:포트
INFO:     Hardware URL: http://실제_Hardware_서버_IP:포트
INFO:     Gateway 연결 테스트 성공
INFO:     Hardware 연결 테스트 성공
```

## 📊 성능 최적화

### **권장 사양**
- **CPU**: 2코어 이상
- **RAM**: 4GB 이상
- **네트워크**: 안정적인 인터넷 연결

### **최적화 팁**
1. **동시 실행 제한**: 한 번에 하나의 데모만 실행
2. **메모리 관리**: 데모 완료 후 터미널 정리
3. **네트워크 대기**: 요청 간 2초 간격 유지

## 🎉 데모 완료

### **성공적인 데모 실행 시**
```
🎉 스마트 홈 AI 추천 데모 완료!
💡 다양한 기상 조건과 시간대에서 AI 추천을 시연했습니다!
🚀 Gateway에 등록된 실제 기기만 추천하는 스마트한 AI를 확인했습니다!
```

### **데모 특징**
- ✅ **30분 대기 없이** 즉시 시연 가능
- ✅ **다양한 기상 조건** 시나리오 제공
- ✅ **실제 사용자 입력** (YES/NO) 받기
- ✅ **실제 Gateway/Hardware 서버** 연결
- ✅ **실제 스마트 기기 제어** 실행
- ✅ **상태 기반 스마트 추천** 구현

### **대회용 데모 vs 개발자용 테스트**

| 구분 | 대회용 데모 | 개발자용 테스트 |
|------|-------------|-----------------|
| **서버** | 실제 Gateway/Hardware | Mock 서버 |
| **기기 제어** | 실제 스마트 기기 | 시뮬레이션 |
| **사용자 입력** | 실제 Hardware 서버 | Mock 응답 |
| **목적** | 프레젠테이션/대회 | 개발/테스트 |
| **파일** | `run_demo.py` | `dev_auto_test.py` |

---

**이 가이드는 GazeHome AI Services의 데모 실행 방법을 단계별로 설명합니다.**
